{% extends 'base.html' %}
{% block content %}

{% for object in video.video_challenge%}
<a href="../challenge/{{ object.challenge_name }}"><h1>{{ object.challenge_name }}</h1></a>
{% endfor %}

<p>Uploaded at {{video.date_uploaded }} </p>

<br><br>
Tags:<br>
{% for tag in video.video_tag %}
<span>{{tag.tag_name }}!</span>
{% endfor %}
<br><br>

<form>
	<input type="hidden" name="video_id" id="video_id" value="{{ video.video_id }}">
</form>

<video width="320" height="240" controls>
	<source src="/static/uploads/{{ video.filename }}" type="video/{{ video.filename.rsplit('.', 1)[1] }}">

	Your browser doesn't support videos. Consider upgrading to a newer version.
</video>

<div>
This video got:<br>

{% for point in points %}
	{% if point.point_category != 'social' and point.point_category != 'completion' %}
		<span id='{{ point.point_category }}_score' >{{ point.total_points }}</span>
		<button class='{{ point.point_category }}' id="{{ point.point_category }}" onclick=getPoints({{ point.point_category }})>
		{{ point.point_category }}</button>

	{% endif %}

{% endfor %}
</div>

<script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>

<script type="text/javascript">
	function getPoints(test){
		// debugger;
		let data = {
			"video_id" : $('#video_id').val(),
			"category_id" : test.id
		};
		console.log(data)
		$.post("/add_point", data, addPoint);
	}
	function addPoint(results) {
		console.log('in addPoint function')
		let category = results['cat_id'];
		console.log(category)
		let value = results['value'];
		console.log(value)
		let cat = `#${category}`
		console.log(category)
		$(`${cat}_score`).html(results['value']);
		$(cat).prop("disabled", true);
	}


</script>




{% endblock %}